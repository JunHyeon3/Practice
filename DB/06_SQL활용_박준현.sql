DROP TABLE film_actor;
DROP TABLE film;
DROP TABLE actor;

CREATE TABLE film_actor( 
    actor_id NUMBER ,
    film_id NUMBER,
    CONSTRAINT actor_id FOREIGN KEY(actor_id) REFERENCES actor(actor_id),
    CONSTRAINT film_id FOREIGN KEY(film_id) REFERENCES film(film_id)
);

CREATE TABLE film( 
    film_id NUMBER(5, 0) PRIMARY KEY,
    title VARCHAR2(255),
    description VARCHAR2(255),
    release_year NUMBER,
    production_company VARCHAR2(100)
);

CREATE TABLE actor( 
    actor_id NUMBER(5, 0) PRIMARY KEY,
    name VARCHAR2(45),
    birth_date DATE
);

DESC FILM_ACTOR;
DESC ACTOR;
DESC FILM;



INSERT INTO FILM_ACTOR VALUES(2, 1001);
INSERT INTO FILM_ACTOR VALUES(3, 1001);
INSERT INTO FILM_ACTOR VALUES(2, 1002);
INSERT INTO FILM_ACTOR VALUES(5, 1002);
INSERT INTO FILM_ACTOR VALUES(2, 1003);
INSERT INTO FILM_ACTOR VALUES(4, 1003);
INSERT INTO FILM_ACTOR VALUES(1, 1004);
INSERT INTO FILM_ACTOR VALUES(2, 1004);
INSERT INTO FILM_ACTOR VALUES(2, 1005);
INSERT INTO FILM_ACTOR VALUES(4, 1005);
INSERT INTO FILM_ACTOR VALUES(6, 1006);

INSERT INTO FILM VALUES(1001, '초록물고기', '이창동감독의 데뷔작', 1997, '이스트필름');
INSERT INTO FILM VALUES(1002, '접속', 'PC통신을 통해 신청자에게 접속하면서 생기는 로맨스', 1997, '명필름');
INSERT INTO FILM VALUES(1003, '8월의크리스마스', '허진호감독의 데뷔작', 1998, '우노필름');
INSERT INTO FILM VALUES(1004, '쉬리', '국내 첩보 액션 스릴러 영화', 1999, '(주)강제규필름');
INSERT INTO FILM VALUES(1005, '텔미썸딩', '이승현감독의 데뷔작', 1999, '쿠앤씨필름');
INSERT INTO FILM VALUES(1006, '시월애', '이승현감독의 데뷔작', 2000, '싸이더스');

INSERT INTO ACTOR VALUES(1, '송강호', '1967/01/27');
INSERT INTO ACTOR VALUES(2, '한석규', '1964/11/03');
INSERT INTO ACTOR VALUES(3, '문성근', '1953/05/28');
INSERT INTO ACTOR VALUES(4, '심은하', '1972/09/23');
INSERT INTO ACTOR VALUES(5, '전도연', '1973/02/11');
INSERT INTO ACTOR VALUES(6, '이정재', '1981/10/30');

SELECT * FROM FILM_ACTOR;
SELECT * FROM FILM;
SELECT * FROM ACTOR;



--1999년 이후에 제작된 영화 수를 조회하시오.
SELECT COUNT(*) AS "1999년 이후 제작 영화" FROM FILM WHERE RELEASE_YEAR >= '1999';

--1999년에 개봉된 영화를 조회하시오.
SELECT TITLE AS "1999년 개봉 영화" FROM FILM WHERE RELEASE_YEAR = '1999';

--쉬리에 출연한 배우 이름을 조회하시오. 단, 조인과 서브 쿼리로 작성하시오. 
SELECT NAME AS "쉬리 출연 배우" FROM ACTOR 
WHERE ACTOR_ID IN (SELECT ACTOR_ID FROM FILM_ACTOR WHERE FILM_ID = 1004);

SELECT NAME AS "쉬리 출연 배우" FROM ACTOR 
WHERE ACTOR_ID IN (SELECT ACTOR_ID FROM FILM F, FILM_ACTOR FA WHERE F.FILM_ID = FA.FILM_ID AND TITLE = '쉬리');

--한석규 배우가 출연한 영화 수를 조회하시오. 
SELECT COUNT(*) || '편' AS "한석규 배우 영화 수" FROM FILM_ACTOR WHERE ACTOR_ID = 2;

--1970년대에 태어난 배우 이름과 생년월일을 조회하시오.
SELECT NAME AS "이름", BIRTH_DATE AS "생년월일" FROM ACTOR 
WHERE BIRTH_DATE >= TO_DATE('1970', 'YYYY') AND BIRTH_DATE <= TO_DATE('1979', 'YYYY');